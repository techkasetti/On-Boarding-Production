<!-- jobPostingConsole.html -  -->
<template>
    <div class="console-container">
        <div class="console-wrapper">
            
            <!-- Header with Back Button -->
            <div class="header-card">
                <div class="header-content">
                    <div class="header-left">
                        <div class="icon-container">
                            <lightning-icon icon-name="standard:work_order" alternative-text="Job Posting" size="medium" variant="inverse"></lightning-icon>
                        </div>
                        <div>
                            <h1 class="header-title">üè• AI Medical Job Posting Console</h1>
                            <p class="header-subtitle">Powered by Google Gemini AI - Comprehensive Medical Hiring</p>
                        </div>
                    </div>
                    <!-- NEW: Back to Admin Button -->
                    <div class="header-right">
                        <lightning-button
                            label="Back to Admin"
                            icon-name="utility:back"
                            variant="neutral"
                            onclick={navigateToAdmin}
                            class="back-button">
                        </lightning-button>
                    </div>
                </div>
            </div>

            <!-- Main Card -->
            <div class="main-card">
                <!-- Tabs -->
                <lightning-tabset active-tab-value={activeTab} onactive={handleTabChange} variant="scoped">
                    
                    <!-- Natural Language Tab -->
                    <lightning-tab label="Natural Language" value="nlp" icon-name="utility:sparkles">
                        <div class="tab-content">
                            <div class="info-box info-box-blue">
                                <div class="info-header">
                                    <lightning-icon icon-name="utility:sparkles" size="small"></lightning-icon>
                                    <h3>Describe your medical job posting in plain English</h3>
                                </div>
                                <p class="info-text">
                                    AI will automatically extract job details AND all requirements (education, licenses, certifications, skills, procedures, compliance)
                                </p>
                            </div>
                            
                            <div class="example-box">
                                <p class="example-text">
                                    <strong>Example:</strong> "We need a Duty Doctor for Emergency department at City General Hospital in Chennai, Tamil Nadu, India. 
                                    The position requires MBBS degree, valid Medical Council Registration, BLS and ACLS certifications. 
                                    Required skills include Patient Assessment and Emergency Management at advanced level. 
                                    Must be able to perform IV Cannulation and Wound Suturing. 
                                    2-10 years experience. Starts February 1, 2026. HIPAA compliance required."
                                    <br><br>
                                    <strong>Note:</strong> Be specific! AI will only extract information you explicitly mention. 
                                    Required minimum: Job Title, Role Type, Facility Name, City, State, and Country.
                                </p>
                            </div>
                            
                            <div class="input-group">
                                <label class="input-label">Job Description</label>
                                <lightning-textarea
                                    value={nlpInput}
                                    onchange={handleNLPInputChange}
                                    onkeydown={handleKeyDown}
                                    placeholder="Enter comprehensive job description including requirements for education, licenses, certifications, skills, and procedures..."
                                    class="custom-textarea"
                                    rows="10">
                                </lightning-textarea>
                                <p class="char-count">{characterCount} characters</p>
                            </div>

                            <div class="button-group">
                                <lightning-button
                                    label="Generate Comprehensive Job Posting with AI"
                                    icon-name="utility:sparkles"
                                    variant="brand"
                                    onclick={handleNLPSubmit}
                                    disabled={isProcessing}
                                    class="primary-button">
                                </lightning-button>
                                <lightning-button
                                    label="Clear"
                                    variant="neutral"
                                    onclick={handleClear}
                                    disabled={isProcessing}>
                                </lightning-button>
                            </div>
                        </div>
                    </lightning-tab>
                    
                    <!-- CSV Upload Tab -->
                    <lightning-tab label="CSV Upload" value="csv" icon-name="utility:upload">
                        <div class="tab-content">
                            <div class="info-box info-box-green">
                                <div class="info-header">
                                    <lightning-icon icon-name="utility:upload" size="small"></lightning-icon>
                                    <h3>Upload multiple job postings via CSV</h3>
                                </div>
                                <p class="info-text">
                                    Bulk create jobs by uploading a CSV file with all required fields
                                </p>
                            </div>

                            <div class="input-group">
                                <label class="input-label">Select CSV File</label>
                                <input 
                                    type="file" 
                                    accept=".csv" 
                                    onchange={handleCSVUpload}
                                    class="file-input">
                            </div>

                            <template if:true={fileName}>
                                <div class="file-selected-box">
                                    <p class="file-selected-text">
                                        ‚úì Selected file: <strong>{fileName}</strong>
                                    </p>
                                </div>
                            </template>

                            <div class="button-group">
                                <lightning-button
                                    label="Process CSV File"
                                    icon-name="utility:upload"
                                    variant="brand"
                                    onclick={handleCSVSubmit}
                                    disabled={isProcessing}
                                    class="primary-button">
                                </lightning-button>
                                <lightning-button
                                    label="Download Sample CSV"
                                    icon-name="utility:download"
                                    variant="neutral"
                                    onclick={handleDownloadSample}>
                                </lightning-button>
                            </div>
                        </div>
                    </lightning-tab>

                </lightning-tabset>

                <!-- Loading Spinner -->
                <template if:true={isProcessing}>
                    <div class="loading-container">
                        <div class="loading-content">
                            <lightning-spinner alternative-text="Processing" size="medium"></lightning-spinner>
                            <p class="loading-text">AI is processing your request with Gemini...</p>
                        </div>
                    </div>
                </template>
            </div>
        </div>
    </div>
</template>