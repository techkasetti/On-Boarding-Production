<!-- <template>
    <div class="admin-container">
       
        <div class="admin-header">
            <lightning-card>
                <div class="slds-p-around_medium">
                    <div class="slds-grid slds-grid_align-spread slds-grid_vertical-align-center">
                        <div class="slds-col">
                            <div class="slds-media slds-media_center">
                                <div class="slds-media__figure">
                                    <lightning-icon icon-name="standard:work_order" size="large"></lightning-icon>
                                </div>
                                <div class="slds-media__body">
                                    <h1 class="slds-text-heading_large">Job Posting Management</h1>
                                    <p class="slds-text-body_small slds-text-color_weak">
                                        Manage and organize all job postings
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-col slds-no-flex">
                            <lightning-button 
                                label="New Job Posting" 
                                variant="brand" 
                                icon-name="utility:add"
                                onclick={handleNew}
                                class="new-job-button">
                            </lightning-button>
                        </div>
                    </div>

                    <div class="slds-grid slds-gutters slds-m-top_medium">
                        <div class="slds-col slds-size_1-of-1 slds-medium-size_2-of-3">
                            <lightning-input
                                type="search"
                                label="Search Jobs"
                                placeholder="Search by job title, category, location, or status..."
                                value={searchKey}
                                onchange={handleSearch}
                                variant="label-hidden">
                            </lightning-input>
                        </div>
                        <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-3">
                            <div class="stats-card">
                                <lightning-icon icon-name="utility:rows" size="x-small"></lightning-icon>
                                <span class="stats-number">{totalJobs}</span>
                                <span class="stats-label">Total Jobs</span>
                            </div>
                        </div>
                    </div>
                </div>
            </lightning-card>
        </div>

      
        <div class="slds-m-top_medium">
            <lightning-card>
                <template if:true={isLoading}>
                    <div class="slds-is-relative slds-p-vertical_xx-large">
                        <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                    </div>
                </template>

                <template if:false={isLoading}>
                    <template if:true={hasJobs}>
                        <div class="datatable-container">
                            <lightning-datatable
                                key-field="Id"
                                data={filteredJobPostings}
                                columns={columns}
                                onrowaction={handleRowAction}
                                hide-checkbox-column>
                            </lightning-datatable>
                        </div>
                    </template>

                    <template if:false={hasJobs}>
                        <div class="slds-p-around_xx-large slds-text-align_center">
                            <lightning-icon icon-name="utility:search" size="large" class="slds-m-bottom_small"></lightning-icon>
                            <h3 class="slds-text-heading_medium slds-m-bottom_x-small">No job postings found</h3>
                            <p class="slds-text-color_weak">
                                <template if:true={searchKey}>
                                    Try adjusting your search terms
                                </template>
                                <template if:false={searchKey}>
                                    Create your first job posting to get started
                                </template>
                            </p>
                        </div>
                    </template>
                </template>
            </lightning-card>
        </div>

       
        <template if:true={isModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_large">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" 
                                title="Close" 
                                onclick={closeModal}>
                            <lightning-icon icon-name="utility:close" size="small" alternative-text="Close"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 class="slds-modal__title slds-hyphenate">{modalTitle}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-grid slds-wrap slds-gutters">
                          
                            <div class="slds-col slds-size_1-of-1">
                                <lightning-input 
                                    label="Job Title" 
                                    value={currentJob.Name} 
                                    onchange={handleChange} 
                                    data-field="Name" 
                                    required
                                    placeholder="Enter job title">
                                </lightning-input>
                            </div>

                           
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="category"
                                    label="Category"
                                    value={currentJob.Category__c}
                                    placeholder="Select Category"
                                    options={categoryOptions}
                                    onchange={handleChange}
                                    data-field="Category__c">
                                </lightning-combobox>
                            </div>

                            
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="specialization"
                                    label="Specialization"
                                    value={currentJob.Specialization__c}
                                    placeholder="Select Specialization"
                                    options={specializationOptions}
                                    onchange={handleChange}
                                    data-field="Specialization__c">
                                </lightning-combobox>
                            </div>

                      
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input 
                                    label="Location" 
                                    value={currentJob.Location__c} 
                                    onchange={handleChange} 
                                    data-field="Location__c"
                                    placeholder="e.g., San Francisco, CA">
                                </lightning-input>
                            </div>

                         
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="experience"
                                    label="Experience Level"
                                    value={currentJob.Experience_Level__c}
                                    placeholder="Select Experience Level"
                                    options={experienceOptions}
                                    onchange={handleChange}
                                    data-field="Experience_Level__c">
                                </lightning-combobox>
                            </div>

                        
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="status"
                                    label="Status"
                                    value={currentJob.Status__c}
                                    placeholder="Select Status"
                                    options={statusOptions}
                                    onchange={handleChange}
                                    data-field="Status__c"
                                    required>
                                </lightning-combobox>
                            </div>

                     
                            <div class="slds-col slds-size_1-of-1">
                                <lightning-textarea 
                                    label="Job Description" 
                                    value={currentJob.Description__c} 
                                    onchange={handleChange} 
                                    data-field="Description__c"
                                    placeholder="Enter detailed job description..."
                                    rows="6">
                                </lightning-textarea>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <lightning-button 
                            label="Cancel" 
                            onclick={closeModal}>
                        </lightning-button>
                        <lightning-button 
                            label="Save" 
                            variant="brand" 
                            onclick={handleSave}
                            disabled={isLoading}>
                        </lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

     
        <template if:true={isDeleteModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <h2 class="slds-modal__title">Confirm Delete</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-text-align_center">
                            <lightning-icon icon-name="utility:warning" size="large" variant="warning" class="slds-m-bottom_small"></lightning-icon>
                            <p class="slds-text-heading_small slds-m-bottom_small">
                                Are you sure you want to delete this job posting?
                            </p>
                            <p class="slds-text-body_regular slds-text-color_weak">
                                <strong>{jobToDelete.Name}</strong>
                            </p>
                            <p class="slds-text-body_small slds-text-color_weak slds-m-top_small">
                                This action cannot be undone.
                            </p>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <lightning-button 
                            label="Cancel" 
                            onclick={closeDeleteModal}>
                        </lightning-button>
                        <lightning-button 
                            label="Delete" 
                            variant="destructive" 
                            onclick={confirmDelete}
                            disabled={isLoading}>
                        </lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
    </div>
</template> -->

<template>
    <div class="admin-container">
        <!-- Header Section -->
        <div class="admin-header">
            <lightning-card>
                <div class="slds-p-around_medium">
                    <div class="slds-grid slds-grid_align-spread slds-grid_vertical-align-center">
                        <div class="slds-col">
                            <div class="slds-media slds-media_center">
                                <div class="slds-media__figure">
                                    <lightning-icon icon-name="standard:work_order" size="large"></lightning-icon>
                                </div>
                                <div class="slds-media__body">
                                    <h1 class="slds-text-heading_large">Job Posting Management</h1>
                                    <p class="slds-text-body_small slds-text-color_weak">
                                        Manage and organize all job postings
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="slds-col slds-no-flex">
                            <lightning-button 
                                label="New Job Posting" 
                                variant="brand" 
                                icon-name="utility:add"
                                onclick={handleNew}
                                class="new-job-button">
                            </lightning-button>
                        </div>
                    </div>

                    <!-- Search and Stats -->
                    <div class="slds-grid slds-gutters slds-m-top_medium">
                        <div class="slds-col slds-size_1-of-1 slds-medium-size_2-of-3">
                            <lightning-input
                                type="search"
                                label="Search Jobs"
                                placeholder="Search by job title, category, location, or status..."
                                value={searchKey}
                                onchange={handleSearch}
                                variant="label-hidden">
                            </lightning-input>
                        </div>
                        <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-3">
                            <div class="stats-card">
                                <lightning-icon icon-name="utility:rows" size="x-small"></lightning-icon>
                                <span class="stats-number">{totalJobs}</span>
                                <span class="stats-label">Total Jobs</span>
                            </div>
                        </div>
                    </div>
                </div>
            </lightning-card>
        </div>

        <!-- Data Table Section -->
        <div class="slds-m-top_medium">
            <lightning-card>
                <template if:true={isLoading}>
                    <div class="slds-is-relative slds-p-vertical_xx-large">
                        <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                    </div>
                </template>

                <template if:false={isLoading}>
                    <template if:true={hasJobs}>
                        <div class="datatable-container">
                            <lightning-datatable
                                key-field="Id"
                                data={filteredJobPostings}
                                columns={columns}
                                onrowaction={handleRowAction}
                                hide-checkbox-column>
                            </lightning-datatable>
                        </div>
                    </template>

                    <template if:false={hasJobs}>
                        <div class="slds-p-around_xx-large slds-text-align_center">
                            <lightning-icon icon-name="utility:search" size="large" class="slds-m-bottom_small"></lightning-icon>
                            <h3 class="slds-text-heading_medium slds-m-bottom_x-small">No job postings found</h3>
                            <p class="slds-text-color_weak">
                                <template if:true={searchKey}>
                                    Try adjusting your search terms
                                </template>
                                <template if:false={searchKey}>
                                    Create your first job posting to get started
                                </template>
                            </p>
                        </div>
                    </template>
                </template>
            </lightning-card>
        </div>

        <!-- Edit/Create Modal -->
        <template if:true={isModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_large">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" 
                                title="Close" 
                                onclick={closeModal}>
                            <lightning-icon icon-name="utility:close" size="small" alternative-text="Close"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 class="slds-modal__title slds-hyphenate">{modalTitle}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-grid slds-wrap slds-gutters">
                            <!-- Job Title -->
                            <div class="slds-col slds-size_1-of-1">
                                <lightning-input 
                                    label="Job Title" 
                                    value={currentJob.Name} 
                                    onchange={handleChange} 
                                    data-field="Name" 
                                    required
                                    placeholder="Enter job title">
                                </lightning-input>
                            </div>

                            <!-- Category -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="category"
                                    label="Category"
                                    value={currentJob.Category__c}
                                    placeholder="Select Category"
                                    options={categoryOptions}
                                    onchange={handleChange}
                                    data-field="Category__c">
                                </lightning-combobox>
                            </div>

                            <!-- Specialization -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="specialization"
                                    label="Specialization"
                                    value={currentJob.Specialization__c}
                                    placeholder="Select Specialization"
                                    options={specializationOptions}
                                    onchange={handleChange}
                                    data-field="Specialization__c">
                                </lightning-combobox>
                            </div>

                            <!-- Location -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input 
                                    label="Location" 
                                    value={currentJob.Location__c} 
                                    onchange={handleChange} 
                                    data-field="Location__c"
                                    placeholder="e.g., San Francisco, CA">
                                </lightning-input>
                            </div>

                            <!-- Experience Level -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="experience"
                                    label="Experience Level"
                                    value={currentJob.Experience_Level__c}
                                    placeholder="Select Experience Level"
                                    options={experienceOptions}
                                    onchange={handleChange}
                                    data-field="Experience_Level__c">
                                </lightning-combobox>
                            </div>

                            <!-- Start Date -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input 
                                    type="date"
                                    label="Start Date" 
                                    value={currentJob.Start_Date__c} 
                                    onchange={handleChange} 
                                    data-field="Start_Date__c"
                                    placeholder="Select start date">
                                </lightning-input>
                            </div>

                            <!-- End Date -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input 
                                    type="date"
                                    label="End Date" 
                                    value={currentJob.End_Date__c} 
                                    onchange={handleChange} 
                                    data-field="End_Date__c"
                                    min={currentJob.Start_Date__c}
                                    placeholder="Select end date">
                                </lightning-input>
                            </div>

                            <!-- Status -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox
                                    name="status"
                                    label="Status"
                                    value={currentJob.Status__c}
                                    placeholder="Select Status"
                                    options={statusOptions}
                                    onchange={handleChange}
                                    data-field="Status__c"
                                    required>
                                </lightning-combobox>
                            </div>

                            <!-- Description -->
                            <div class="slds-col slds-size_1-of-1">
                                <lightning-textarea 
                                    label="Job Description" 
                                    value={currentJob.Description__c} 
                                    onchange={handleChange} 
                                    data-field="Description__c"
                                    placeholder="Enter detailed job description..."
                                    rows="6">
                                </lightning-textarea>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <lightning-button 
                            label="Cancel" 
                            onclick={closeModal}>
                        </lightning-button>
                        <lightning-button 
                            label="Save" 
                            variant="brand" 
                            onclick={handleSave}
                            disabled={isLoading}>
                        </lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <!-- Delete Confirmation Modal -->
        <template if:true={isDeleteModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <h2 class="slds-modal__title">Confirm Delete</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="slds-text-align_center">
                            <lightning-icon icon-name="utility:warning" size="large" variant="warning" class="slds-m-bottom_small"></lightning-icon>
                            <p class="slds-text-heading_small slds-m-bottom_small">
                                Are you sure you want to delete this job posting?
                            </p>
                            <p class="slds-text-body_regular slds-text-color_weak">
                                <strong>{jobToDelete.Name}</strong>
                            </p>
                            <p class="slds-text-body_small slds-text-color_weak slds-m-top_small">
                                This action cannot be undone.
                            </p>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <lightning-button 
                            label="Cancel" 
                            onclick={closeDeleteModal}>
                        </lightning-button>
                        <lightning-button 
                            label="Delete" 
                            variant="destructive" 
                            onclick={confirmDelete}
                            disabled={isLoading}>
                        </lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
    </div>
</template>